# Default values for librenms.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Allow use of images from bitnamilegacy repository
global:
  security:
    allowInsecureImages: true

librenms:
  image:
    # -- repository is the image repository to pull from.
    repository: librenms/librenms
    # -- tag is image tag to pull.
    tag: 25.11.0

  # -- Laravel appkey used by LibreNMS, this should be generated by you and is a
  # required setting. See the README for more information
  appkey:

  # -- Existing secret name to use for appkey
  # Must have the key 'appkey' as above
  existingSecret: false

  # -- Timezone used by librenms for communication with RRD cached
  timezone: UTC

  # -- Custom configuration options for LibreNMS. For more information on options
  # in this file check the following link:
  # https://docs.librenms.org/Support/Configuration/
  configuration: |
    $config['distributed_poller_group']          = '0';
    $config['distributed_poller']                = true;

  # -- Extra environment variables applied to all LibreNMS components
  extraEnvs: []

  # -- Extra envFrom sources applied to all LibreNMS components
  extraEnvFrom: []

  # Global setting to run components as privileged, set as a bool
  # Optionally, the frontend and pollers can be individually run as privileged
  privileged: false

  # -- initContainer configuration options
  initContainer:
    image:
      # -- repository is the init container image repository to pull from.
      repository: busybox
      # -- tag is the init container image tag to pull.
      tag: "1.37"
    # -- resources defines the computing resources (CPU and memory)
    # that are allocated to the init container.
    resources: {}
      # requests:
      #   cpu: 10m
      #   memory: 16Mi
      # limits:
      #   cpu: 50m
      #   memory: 32Mi

  # Frontend container configurations options
  frontend:
    # -- Frontend replicas
    replicas: 1
    readinessProbe:
      httpGet:
        # -- Check endpoint path
        path: /login
        # -- Check endpoint port
        port: 8000
      initialDelaySeconds: 30
      periodSeconds: 60
      timeoutSeconds: 10
    # -- resources defines the computing resources (CPU and memory)
    # that are allocated to the containers running within the Pod.
    resources: {}
      # We usually recommend not to specify default resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      # requests:
      #   cpu: 50m
      #   memory: 150M

    # Bool to control running the frontend pods as privileged
    # The default is false.
    privileged: false

    # -- nodeSelector for frontend pods
    nodeSelector: {}

    # -- Extra volumes for frontend pods
    extraVolumes: []

    # -- Extra volume mounts for frontend containers
    extraVolumeMounts: []

    # -- Extra environment variables for frontend containers
    extraEnvs: []

    # -- Extra envFrom sources for frontend containers
    extraEnvFrom: []

  # Distributed poller container configurations options
  poller:
    # -- Poller replicas
    replicas: 2
    # -- resources defines the computing resources (CPU and memory)
    # that are allocated to the containers running within the Pod.
    resources: {}
      # requests:
      #   cpu: 500m
      #   memory: 200M

    # Bool to control running the poller pods as privileged
    # The default is false
    privileged: false

    # -- nodeSelector for poller pods
    nodeSelector: {}

    # -- Extra volumes for poller pods
    extraVolumes: []

    # -- Extra volume mounts for poller containers
    extraVolumeMounts: []

    # -- Extra environment variables for poller containers
    extraEnvs: []

    # -- Extra envFrom sources for poller containers
    extraEnvFrom: []

  # -- SNMP network discovery scanner cron job. This job is optional and only use
  # when having snmp network discovery enabled. For this to work either set the
  # 'nets' configuration in the custom config on in the admin interface
  # See the following link for more information:
  # https://docs.librenms.org/Extensions/Auto-Discovery/
  snmp_scanner:
    # -- SNMP scanner enabled
    enabled: false
    # -- SNMP scanner cornjob syntac interval
    cron: 15 * * * *
    # -- securityContext defines the security settings for the SNMP scanner pod.
    # These settings are required for the SNMP scanner to run properly.
    # See: https://github.com/librenms/docker/pull/530
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      runAsGroup: 1000
      fsGroup: 1000
    # -- resources defines the computing resources (CPU and memory)
    # that are allocated to the containers running within the Pod.
    resources: {}
      # requests:
      #   cpu: 500m
      #   memory: 200M

    # -- nodeSelector for SNMP scanner pods
    nodeSelector: {}

    # -- Extra environment variables for SNMP scanner containers
    extraEnvs: []

    # -- Extra envFrom sources for SNMP scanner containers
    extraEnvFrom: []

  # -- RRD cached is the tool that allows for distributed polling and is mandatory
  # in this LibreNMS helm chart. See the rrdcached documentation for more
  # information: https://oss.oetiker.ch/rrdtool/doc/rrdcached.en.html
  rrdcached:
    image:
      # -- repository is the image repository to pull from.
      repository: crazymax/rrdcached
      # -- tag is image tag to pull.
      tag: 1.8.0
    persistence:
      # -- RRDCached persistent volume enabled
      enabled: true
      journal:
        # -- RRDCached journal PV size
        size: 1Gi
        # -- RRDCached journal storage class name
        storageClassName: ""
      rrdcached:
        # -- RRDCached RRD storage PV size
        size: 10Gi
        # -- RRDCached RRD storage class name
        storageClassName: ""
    # -- resources defines the computing resources (CPU and memory)
    # that are allocated to the containers running within the Pod.
    resources: {}
      # requests:
      #   cpu: 100m
      #   memory: 500M
    readinessProbe:
      # -- RRD cached readiness probe
      tcpSocket:
        port: 42217
      initialDelaySeconds: 5
      periodSeconds: 10
    livenessProbe:
      # -- RRD cached liveness probe
      tcpSocket:
        port: 42217
      initialDelaySeconds: 15
      periodSeconds: 20
    envs:
    # -- env variables RRD Cached
    - name: WRITE_JITTER
      value: "1800"
    - name: WRITE_TIMEOUT
      value: "1800"

    # -- Extra environment variables for RRDCached containers
    extraEnvs: []

    # -- Extra envFrom sources for RRDCached containers
    extraEnvFrom: []

    # -- nodeSelector for rrdcached pods
    nodeSelector: {}

    # -- Extra volumes for rrdcached pods
    extraVolumes: []

    # -- Extra volume mounts for rrdcached containers
    extraVolumeMounts: []

# -- LibreNMS ingress configuration
ingress:
  # -- Enable or disable ingress
  enabled: false
  # -- Ingress class name
  className: ""
  # -- Ingress annotations
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  # -- Ingress ingress rules
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

# -- Configuration for MySQL dependency chart by Bitnami. See their chart for
# more information: https://github.com/bitnami/charts/tree/master/bitnami/mysql
mysql:
  enabled: true
  # Work around for Bitnami dropping support
  # https://github.com/bitnami/charts/issues/35164
  # https://github.com/bitnami/charts/issues/35256
  image:
    repository: bitnamilegacy/mysql
  auth:
    username: librenms
    database: librenms

# -- Configuration for redis dependency chart by Bitnami. See their chart for
# more information: https://github.com/bitnami/charts/tree/master/bitnami/redis
redis:
  enabled: true
  # Work around for Bitnami dropping support
  # https://github.com/bitnami/charts/issues/35164
  # https://github.com/bitnami/charts/issues/35256
  image:
    repository: bitnamilegacy/redis
  auth:
    enabled: false
    sentinel: false
  sentinel:
    enabled: false
  master:
    disableCommands: []
  architecture: standalone
